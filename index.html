<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Para Wen</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700;900&family=Playfair+Display:ital@0;1&display=swap');

        :root {
            --gold: #ffd700;
            --gold-shadow: #b8860b;
            --ink: #2c1b18;
            --spell-glow: rgba(0, 255, 255, 0.6);
        }

        body {
            margin: 0;
            height: 100vh;
            overflow: hidden;
            background-color: #000;
            font-family: 'Playfair Display', serif;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        /* --- FONDO PERGAMINO (Con textura) --- */
        #parchment {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: #e3d4ad;
            background-image: url("https://www.transparenttextures.com/patterns/aged-paper.png");
            box-shadow: inset 0 0 100px rgba(0,0,0,0.5);
            opacity: 0;
            transition: opacity 2s ease-in;
            z-index: 0;
        }

        /* --- INTRODUCCI√ìN (NEGRO Y ORO) --- */
        #intro-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000;
            z-index: 100;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            transition: opacity 1.5s ease-out;
            cursor: pointer;
        }

        .typewriter {
            font-family: 'Cinzel Decorative', serif;
            color: var(--gold);
            font-size: 1.5rem;
            text-shadow: 0 0 10px var(--gold-shadow);
            border-right: 2px solid var(--gold);
            white-space: nowrap;
            overflow: hidden;
            animation: typing 3.5s steps(40, end), blink .75s step-end infinite;
            max-width: 90%;
        }

        .tap-hint {
            color: #666; font-size: 0.8rem; margin-top: 20px;
            opacity: 0; animation: fadeIn 2s forwards 3.5s;
        }

        /* --- CONTENIDO DEL JUEGO --- */
        #game-content {
            position: relative; z-index: 10;
            width: 90%; max-width: 600px;
            opacity: 0; display: none;
            transition: opacity 1s;
        }

        h1, h2, h3 {
            font-family: 'Cinzel Decorative', serif;
            color: var(--gold);
            /* Sombra negra para que el oro se lea bien en el pergamino */
            text-shadow: 2px 2px 0px #000, 0 0 15px rgba(255, 215, 0, 0.5);
            margin: 10px 0;
        }

        p { font-size: 1.2rem; color: #4a3b32; font-weight: bold; }

        input {
            background: rgba(0,0,0,0.1);
            border: none; border-bottom: 3px solid var(--gold);
            color: #2c1b18; font-family: 'Cinzel Decorative', serif;
            font-size: 1.5rem; text-align: center; width: 100%;
            padding: 10px; margin: 20px 0; outline: none; font-weight: bold;
        }

        .btn-gold {
            background: linear-gradient(45deg, #d4af37, #ffd700);
            color: #000; border: 2px solid #000;
            padding: 15px 40px; font-family: 'Cinzel Decorative', serif;
            font-weight: 900; font-size: 1.1rem;
            cursor: pointer; border-radius: 5px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transition: transform 0.2s;
            margin-top: 10px;
        }
        .btn-gold:active { transform: scale(0.95); }

        /* --- ANIMACIONES Y EFECTOS --- */
        
        /* Destello M√°gico (Lento y elegante) */
        #flash-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle, rgba(255,255,255,0.8) 0%, rgba(173, 216, 230, 0.4) 50%, transparent 100%);
            opacity: 0; pointer-events: none; z-index: 50;
            transition: opacity 1.5s ease; /* 1.5 segundos de duraci√≥n */
        }
        .flash-active { opacity: 1 !important; }

        /* Huellas */
        .footstep {
            position: absolute; font-size: 24px; color: #4a3b32;
            opacity: 0; transform: rotate(90deg); filter: blur(0.5px);
            z-index: 1; pointer-events: none;
        }

        /* Fuegos Artificiales Finales */
        .firework {
            position: absolute; width: 6px; height: 6px; border-radius: 50%;
            animation: explode 1s ease-out forwards; z-index: 20;
        }

        @keyframes typing { from { width: 0 } to { width: 100% } }
        @keyframes blink { 50% { border-color: transparent } }
        @keyframes fadeIn { to { opacity: 1 } }
        @keyframes explode { to { transform: scale(10); opacity: 0; } }
        @keyframes walk { 0% { opacity: 0; } 50% { opacity: 0.6; } 100% { opacity: 0; } }

        .hidden { display: none !important; }

        /* Estilo bot√≥n NO */
        #no-btn {
            background: transparent; border: none; color: #555;
            box-shadow: none; font-size: 0.9rem;
        }
    </style>
</head>
<body>

<audio id="bg-music" loop>
    <source src="https://ia801309.us.archive.org/23/items/Harry_Potter_Theme_Song_Hedwigs_Theme/Harry_Potter_Theme_Song_Hedwigs_Theme.mp3" type="audio/mpeg">
</audio>

<div id="parchment"></div>

<div id="flash-overlay"></div>

<div id="intro-screen" onclick="startMagic()">
    <div class="typewriter">Juro solemnemente...</div>
    <div class="tap-hint">(Toca la pantalla para comenzar)</div>
</div>

<div id="game-content">
    
    <div id="map-header">
        <h2 style="font-size: 1rem; letter-spacing: 3px;">MESSRS. MOONY, WORMTAIL, PADFOOT & PRONGS</h2>
        <p>Presentan sus respetos a la Srta. <strong>Wen</strong></p>
        <hr style="border: 1px solid #4a3b32; margin: 20px auto; width: 60%;">
    </div>

    <div id="question-box">
        <h1 id="q-text" style="font-size: 1.8rem; line-height: 1.3;">Cargando magia...</h1>
        
        <input type="text" id="ans-input" placeholder="Lumos..." autocomplete="off">
        
        <button class="btn-gold" onclick="castSpell()">‚ú® REVELAR ‚ú®</button>
        <p id="error-msg" style="color: #8b0000; font-size: 1rem; min-height: 20px; margin-top: 15px;"></p>
    </div>

    <div id="final-box" class="hidden">
        <h1 style="font-size: 2.5rem; text-shadow: 0 0 20px #fff, 2px 2px 0 #000;">‚ö° Travesura Realizada ‚ö°</h1>
        <p style="margin: 30px 0; font-size: 1.3rem;">El mapa ha revelado todos sus secretos.</p>
        
        <h2 style="margin-bottom: 30px;">¬øQuieres ser mi San Valent√≠n?</h2>
        
        <button class="btn-gold" style="font-size: 1.3rem;" onclick="finalExplosion()">¬°S√ç, ACEPTO!</button>
        <br>
        <button id="no-btn" class="btn-gold" onclick="handleNo()">No</button>
    </div>

</div>

<script>
    const data = {
        qs: [
            { q: "¬øEn qu√© fecha exacta comenz√≥ nuestra historia? (DD/MM/AAAA)", a: "24/04/2024" },
            { q: "¬øCu√°l fue la primera foto nuestra que te gust√≥?", a: "espejo" },
            { q: "¬øA qu√© lugar m√°gico viajamos juntos por primera vez?", a: "ayacucho" }
        ],
        errs: ["El mapa no miente... intenta de nuevo.", "¬°Por Merl√≠n! Conc√©ntrate.", "La tinta se desvanece... error."]
    };

    let step = 0;
    let noIdx = 0;

    // --- INICIO ---
    function startMagic() {
        const music = document.getElementById('bg-music');
        music.volume = 0.6;
        music.play();

        document.getElementById('intro-screen').style.opacity = 0;
        setTimeout(() => {
            document.getElementById('intro-screen').style.display = 'none';
            
            // Mostrar pergamino
            document.getElementById('parchment').style.opacity = 1;
            
            // Mostrar contenido
            const content = document.getElementById('game-content');
            content.style.display = 'block';
            setTimeout(() => content.style.opacity = 1, 500);
            
            startFootsteps();
            loadQ();
        }, 1500);
    }

    // --- JUEGO ---
    function loadQ() {
        document.getElementById('q-text').innerText = data.qs[step].q;
        document.getElementById('ans-input').value = "";
        document.getElementById('error-msg').innerText = "";
    }

    function castSpell() {
        const val = document.getElementById('ans-input').value.toLowerCase().trim();
        const correct = data.qs[step].a.toLowerCase();
        
        let ok = false;
        if(step === 1 && (val.includes("espejo") || val.includes("foto"))) ok = true;
        else if(val === correct) ok = true;

        if(ok) {
            // DESTELLO LENTO Y ELEGANTE
            const flash = document.getElementById('flash-overlay');
            flash.classList.add('flash-active');
            
            // Vibraci√≥n
            document.body.style.transform = "scale(1.02)";
            setTimeout(() => document.body.style.transform = "scale(1)", 200);

            setTimeout(() => {
                flash.classList.remove('flash-active');
                step++;
                if(step < data.qs.length) loadQ();
                else showFinal();
            }, 1500); // Espera 1.5 segundos (lento)
        } else {
            document.getElementById('error-msg').innerText = data.errs[Math.floor(Math.random()*data.errs.length)];
            document.getElementById('game-content').style.transform = "translateX(10px)";
            setTimeout(()=>document.getElementById('game-content').style.transform = "translateX(0)", 200);
        }
    }

    // --- VISUALES ---
    function startFootsteps() {
        setInterval(() => {
            if(Math.random() > 0.5) return;
            const f = document.createElement('div');
            f.className = 'footstep';
            f.innerHTML = "üë£";
            f.style.left = Math.random() * 80 + 10 + '%';
            f.style.top = Math.random() * 80 + 10 + '%';
            f.style.transform = `rotate(${Math.random()*360}deg)`;
            f.style.animation = "walk 4s forwards";
            document.getElementById('parchment').appendChild(f);
            setTimeout(() => f.remove(), 4000);
        }, 800);
    }

    function showFinal() {
        document.getElementById('question-box').classList.add('hidden');
        document.getElementById('map-header').classList.add('hidden');
        document.getElementById('final-box').classList.remove('hidden');
    }

    function handleNo() {
        const txt = ["¬øSegura?", "Pi√©nsalo bien...", "Imposible.", "Wen..."];
        document.getElementById('no-btn').innerText = txt[noIdx % txt.length];
        noIdx++;
    }

    function finalExplosion() {
        document.querySelector('h2').innerText = "¬°SIEMPRE!";
        document.querySelector('.btn-gold').style.display = 'none';
        document.getElementById('no-btn').style.display = 'none';
        
        // Bucle de fuegos artificiales
        setInterval(() => {
            const fw = document.createElement('div');
            fw.className = 'firework';
            fw.style.left = Math.random() * 100 + '%';
            fw.style.top = Math.random() * 100 + '%';
            fw.style.backgroundColor = Math.random() > 0.5 ? '#ffd700' : '#00bfff';
            document.body.appendChild(fw);
            setTimeout(() => fw.remove(), 1000);
        }, 100);
    }

    // Enter key
    document.getElementById('ans-input').addEventListener("keypress", (e) => {
        if(e.key === "Enter") castSpell();
    });

</script>
</body>
</html>
