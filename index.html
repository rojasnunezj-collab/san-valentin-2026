<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mapa del Merodeador</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@400;700&family=Playfair+Display:ital,wght@0,400;1,400&display=swap');

        :root {
            --gold: #d4af37; /* Dorado Hogwarts */
            --wax: #f0f0f0;  /* Color cera de vela */
            --flame: #ffcc00; /* Color llama */
            --spell: #a6e7ff; /* Azul p√°lido m√°gico */
            --bg-dark: #050510;
        }

        body {
            background: radial-gradient(circle at bottom, #0b0b1a 0%, #000000 100%);
            color: var(--gold);
            font-family: 'Playfair Display', serif;
            margin: 0;
            height: 100vh;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        /* --- VELAS FLOTANTES (CSS PURO) --- */
        #great-hall {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 0;
        }

        .candle {
            position: absolute;
            width: 8px;
            height: 35px;
            background: linear-gradient(to bottom, #fff, #e0e0e0);
            border-radius: 4px;
            box-shadow: 0 5px 10px rgba(0,0,0,0.3);
            animation: float 6s ease-in-out infinite alternate;
        }

        /* La llama de la vela */
        .candle::before {
            content: '';
            position: absolute;
            top: -12px; left: 1px;
            width: 6px; height: 12px;
            background: var(--flame);
            border-radius: 50% 50% 20% 20%;
            box-shadow: 0 0 15px var(--flame), 0 0 30px orange;
            animation: flicker 1s infinite alternate;
        }

        @keyframes float {
            0% { transform: translateY(0); }
            100% { transform: translateY(-20px); }
        }
        @keyframes flicker {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(0.9); opacity: 0.8; }
        }

        /* --- DESTELLO M√ÅGICO SUAVE --- */
        #lumos-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle, rgba(166, 231, 255, 0.4) 0%, transparent 70%);
            opacity: 0; pointer-events: none; z-index: 20;
            transition: opacity 1.5s ease; /* Transici√≥n lenta */
        }
        .active-spell { opacity: 1 !important; }

        /* --- INTERFAZ --- */
        #parchment {
            position: relative; z-index: 10;
            width: 85%; max-width: 500px;
            padding: 30px;
            border: 1px solid rgba(212, 175, 55, 0.3);
            background: rgba(0, 0, 0, 0.6); /* Fondo oscuro semitransparente */
            backdrop-filter: blur(5px);
            border-radius: 20px;
            box-shadow: 0 0 50px rgba(0,0,0,0.5);
            transition: transform 0.5s;
        }

        h1, h2 { font-family: 'Cinzel Decorative', serif; margin: 10px 0; text-shadow: 0 0 10px var(--gold); }
        h1 { font-size: 1.8rem; }
        p { font-size: 1.1rem; line-height: 1.6; }

        .separator {
            height: 2px; width: 100px; background: var(--gold);
            margin: 20px auto; border-radius: 50%;
            box-shadow: 0 0 10px var(--gold);
        }

        input {
            background: transparent; border: none; border-bottom: 2px solid var(--gold);
            color: #fff; font-family: 'Cinzel Decorative', serif;
            font-size: 1.2rem; text-align: center; width: 100%;
            padding: 10px; margin: 25px 0; outline: none;
        }

        .btn {
            background: transparent;
            color: var(--gold);
            border: 2px solid var(--gold);
            padding: 15px 40px;
            font-family: 'Cinzel Decorative', serif;
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.5s;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-top: 10px;
        }

        .btn:hover {
            background: var(--gold);
            color: #000;
            box-shadow: 0 0 30px var(--gold);
        }

        #no-btn { border-color: #666; color: #888; font-size: 0.8rem; padding: 10px 20px; border: none; }

        .hidden { display: none; }

        /* Animaci√≥n final de huellas */
        .footstep {
            position: absolute; font-size: 20px; opacity: 0;
            animation: walk 4s linear forwards;
        }
        @keyframes walk { 0% { opacity: 0; } 20% { opacity: 1; } 80% { opacity: 1; } 100% { opacity: 0; } }

    </style>
</head>
<body>

<audio id="bg-music" loop>
    <source src="https://ia801309.us.archive.org/23/items/Harry_Potter_Theme_Song_Hedwigs_Theme/Harry_Potter_Theme_Song_Hedwigs_Theme.mp3" type="audio/mpeg">
</audio>

<div id="great-hall"></div>

<div id="lumos-overlay"></div>

<div id="parchment">
    
    <div id="screen-start">
        <h1 style="letter-spacing: 3px;">Messrs. Moony, Wormtail, Padfoot & Prongs</h1>
        <div class="separator"></div>
        <p style="font-style: italic;">Presentan sus respetos a la Srta. [NOMBRE DE ELLA] y le piden que realice el encantamiento de apertura.</p>
        <br>
        <button class="btn" onclick="openMap()">Juro solemnemente que mis intenciones no son buenas</button>
    </div>

    <div id="screen-game" class="hidden">
        <h2 id="q-title">Encantamiento I</h2>
        <div class="separator"></div>
        <p id="q-text">Cargando...</p>
        
        <input type="text" id="ans-input" placeholder="Agita tu varita..." autocomplete="off">
        
        <button class="btn" onclick="castSpell()">Lanzar Hechizo</button>
        <p id="feedback" style="min-height: 20px; color: #ff6b6b; font-size: 0.9rem; margin-top: 15px; font-style: italic;"></p>
    </div>

    <div id="screen-final" class="hidden">
        <h1>‚ú® Travesura Realizada ‚ú®</h1>
        <div class="separator"></div>
        <p>El mapa ha revelado el secreto m√°s profundo.</p>
        <br>
        <h2 style="font-size: 1.5rem; line-height: 1.4;">¬øMe har√≠as el honor de ser mi pareja de baile en este San Valent√≠n?</h2>
        <br>
        <button class="btn" onclick="acceptProposal()">¬°S√≠, acepto!</button>
        <br>
        <button id="no-btn" onclick="handleNo()">No (Avada Kedavra)</button>
    </div>

    <div id="screen-love" class="hidden">
        <h1 style="font-size: 3rem;">‚ö° ‚ù§Ô∏è ‚ö°</h1>
        <p style="font-size: 1.2rem;">Nox.</p>
        <p style="font-size: 0.8rem; opacity: 0.7;">(Apaga la luz y b√©same)</p>
    </div>

</div>

<script>
    // --- DATOS DEL JUEGO ---
    const config = {
        questions: [
            { t: "Encantamiento de Tiempo", q: "¬øEn qu√© fecha exacta comenz√≥ nuestra magia? (DD/MM/AAAA)", a: "24/04/2024" },
            { t: "Encantamiento de Reflejo", q: "¬øCu√°l fue la primera foto nuestra que captur√≥ tu coraz√≥n?", a: "espejo" }, // Palabra clave
            { t: "Aparici√≥n Conjunta", q: "¬øA qu√© lugar m√°gico viajamos juntos por primera vez?", a: "ayacucho" }
        ],
        errors: [
            "El Mapa del Merodeador se burla de tu mala memoria.",
            "¬°Por las barbas de Merl√≠n! Intenta de nuevo.",
            "¬øUn hechizo Confundus te ha golpeado?",
            "Respuesta incorrecta. 10 puntos menos para Gryffindor."
        ],
        noTexts: [
            "¬øEst√°s segura? ‚ö°", 
            "El C√°liz de Fuego ya te eligi√≥... üî•", 
            "No puedes enga√±ar a un objeto m√°gico... üìú",
            "¬°Pi√©nsalo bien! üßô‚Äç‚ôÇÔ∏è"
        ]
    };

    let step = 0;
    let noCount = 0;

    // --- GENERAR VELAS FLOTANTES ---
    const hall = document.getElementById('great-hall');
    for(let i=0; i<30; i++) {
        const candle = document.createElement('div');
        candle.classList.add('candle');
        candle.style.left = Math.random() * 100 + '%';
        candle.style.top = Math.random() * 100 + '%';
        // Tama√±os aleatorios para profundidad
        const scale = Math.random() * 0.5 + 0.5; 
        candle.style.transform = `scale(${scale})`;
        candle.style.opacity = Math.random() * 0.5 + 0.5;
        candle.style.animationDelay = Math.random() * 5 + 's';
        hall.appendChild(candle);
    }

    // --- L√ìGICA ---
    function openMap() {
        document.getElementById('bg-music').volume = 0.5;
        document.getElementById('bg-music').play().catch(e => console.log("Audio autoplay bloqueado"));
        
        document.getElementById('screen-start').classList.add('hidden');
        document.getElementById('screen-game').classList.remove('hidden');
        loadQuestion();
    }

    function loadQuestion() {
        const q = config.questions[step];
        document.getElementById('q-title').innerText = q.t;
        document.getElementById('q-text').innerText = q.q;
        document.getElementById('ans-input').value = "";
        document.getElementById('feedback').innerText = "";
    }

    function castSpell() {
        const input = document.getElementById('ans-input').value.toLowerCase().trim();
        const answer = config.questions[step].a.toLowerCase();
        
        // Verificaci√≥n flexible para la pregunta 2 (espejo)
        let isCorrect = false;
        if(step === 1) { 
            if(input.includes("espejo") || input.includes("foto")) isCorrect = true;
        } else {
            if(input === answer) isCorrect = true;
        }

        if(isCorrect) {
            // EFECTO LUMOS (Lento y suave)
            const overlay = document.getElementById('lumos-overlay');
            overlay.classList.add('active-spell');
            
            setTimeout(() => {
                step++;
                overlay.classList.remove('active-spell');
                if(step < config.questions.length) {
                    loadQuestion();
                } else {
                    document.getElementById('screen-game').classList.add('hidden');
                    document.getElementById('screen-final').classList.remove('hidden');
                }
            }, 1500); // 1.5 segundos de luz
        } else {
            document.getElementById('feedback').innerText = config.errors[Math.floor(Math.random() * config.errors.length)];
            // Temblor
            const box = document.getElementById('parchment');
            box.style.transform = "translateX(10px)";
            setTimeout(() => box.style.transform = "translateX(0)", 200);
        }
    }

    function handleNo() {
        const btn = document.getElementById('no-btn');
        btn.innerText = config.noTexts[noCount % config.noTexts.length];
        noCount++;
    }

    function acceptProposal() {
        document.getElementById('screen-final').classList.add('hidden');
        document.getElementById('screen-love').classList.remove('hidden');
        createFootsteps();
    }

    function createFootsteps() {
        setInterval(() => {
            const el = document.createElement('div');
            el.innerHTML = "üë£";
            el.className = 'footstep';
            el.style.left = Math.random() * 80 + 10 + '%';
            el.style.top = Math.random() * 80 + 10 + '%';
            el.style.transform = `rotate(${Math.random()*360}deg)`;
            document.body.appendChild(el);
            setTimeout(() => el.remove(), 4000);
        }, 500);
    }

</script>
</body>
</html>
