<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Para Wen</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&family=Dancing+Script:wght@600&family=IM+Fell+DW+Pica:ital@0;1&display=swap');

        :root {
            --ink: #3e2723;   /* Color tinta oscura */
            --paper: #dcd0b3; /* Color pergamino */
            --paper-dark: #b8aa8a;
            --magic: #6a1b9a; /* P煤rpura m谩gico sutil */
        }

        body {
            background-color: #000; /* Empieza en negro cine */
            margin: 0;
            height: 100vh;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'IM Fell DW Pica', serif; /* Tipograf铆a de libro antiguo */
        }

        /* --- TEXTURA DE PERGAMINO (FONDO) --- */
        #parchment-layer {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle, var(--paper), var(--paper-dark));
            opacity: 0;
            transition: opacity 3s ease-in-out; /* Transici贸n MUY lenta (3 segundos) */
            z-index: 1;
            /* Efecto de papel viejo granulado */
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.1'/%3E%3C/svg%3E");
        }

        /* --- PANTALLA INTRO (NEGRA) --- */
        #intro-layer {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 100;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            color: #ccc;
            transition: opacity 2s ease-out;
        }

        .fade-text {
            font-family: 'Cinzel Decorative', serif;
            font-size: 1.2rem;
            letter-spacing: 3px;
            opacity: 0;
            animation: textReveal 4s forwards; /* 4 segundos de aparici贸n */
        }

        /* --- HUELLAS QUE CAMINAN --- */
        .footstep {
            position: absolute;
            color: var(--ink);
            font-size: 20px;
            opacity: 0;
            transform: rotate(90deg);
            filter: blur(1px);
        }

        /* --- CONTENEDOR CENTRAL --- */
        #map-content {
            position: relative; z-index: 10;
            width: 80%; max-width: 500px;
            text-align: center;
            opacity: 0;
            transition: opacity 2s ease-in 1s; /* Aparece 1s despu茅s del fondo */
        }

        h1, h2 { font-family: 'Cinzel Decorative', serif; color: var(--ink); }
        p { color: var(--ink); font-size: 1.3rem; }

        /* Efecto Tinta Apareciendo */
        .ink-reveal {
            color: transparent;
            text-shadow: 0 0 20px var(--ink);
            animation: inkFocus 2.5s forwards;
        }

        input {
            background: transparent; border: none;
            border-bottom: 2px solid var(--ink);
            color: var(--ink); font-family: 'Dancing Script', cursive;
            font-size: 1.8rem; text-align: center; width: 100%;
            margin: 30px 0; outline: none;
        }

        .btn-magic {
            background: transparent;
            color: var(--ink);
            border: 2px solid var(--ink);
            padding: 15px 40px;
            font-family: 'Cinzel Decorative', serif;
            font-weight: bold;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.5s;
            margin-top: 20px;
        }
        .btn-magic:hover {
            background: var(--ink); color: var(--paper);
            box-shadow: 0 0 15px rgba(62, 39, 35, 0.5);
        }

        .hidden { display: none !important; }

        /* ANIMACIONES */
        @keyframes textReveal { 0% { opacity: 0; letter-spacing: 10px; } 100% { opacity: 1; letter-spacing: 3px; } }
        @keyframes inkFocus { 0% { color: transparent; text-shadow: 0 0 20px var(--ink); } 100% { color: var(--ink); text-shadow: 0 0 0 var(--ink); } }
        
        /* Animaci贸n de huellas caminando */
        @keyframes walk {
            0% { opacity: 0; }
            20% { opacity: 0.6; }
            80% { opacity: 0.6; }
            100% { opacity: 0; }
        }

    </style>
</head>
<body>

<audio id="bg-music" loop>
    <source src="https://ia801309.us.archive.org/23/items/Harry_Potter_Theme_Song_Hedwigs_Theme/Harry_Potter_Theme_Song_Hedwigs_Theme.mp3" type="audio/mpeg">
</audio>

<div id="parchment-layer"></div>

<div id="intro-layer" onclick="startCinematic()">
    <h1 class="fade-text">Juro solemnemente...</h1>
    <p style="font-size: 0.8rem; margin-top: 20px; opacity: 0.5; animation: fadeIn 2s 3s forwards;">(Toca la pantalla)</p>
</div>

<div id="map-content" class="hidden">
    
    <div id="header-section">
        <h2 style="font-size: 1rem; letter-spacing: 2px; border-bottom: 1px solid var(--ink); padding-bottom: 10px; display: inline-block;">MESSRS. MOONY, WORMTAIL, PADFOOT & PRONGS</h2>
        <p style="margin-top: 30px; font-style: italic;">Saludan a la Srta. <strong>Wen</strong></p>
    </div>

    <div id="game-section">
        <p id="q-text" class="ink-reveal" style="font-size: 1.5rem; margin-top: 40px;">Cargando tinta...</p>
        
        <input type="text" id="ans-input" placeholder="Lumos..." autocomplete="off">
        
        <button class="btn-magic" onclick="checkAnswer()">Revelar</button>
        <p id="feedback" style="font-family: 'Dancing Script'; font-size: 1.2rem; color: #8a2be2; min-height: 30px; margin-top: 10px;"></p>
    </div>

    <div id="final-section" class="hidden">
        <h1 style="font-size: 3rem; margin-bottom: 10px;">Travesura Realizada</h1>
        <p style="font-family: 'Dancing Script'; font-size: 1.8rem;">Siempre.</p> <div style="margin-top: 50px;">
             <h2 style="font-size: 1.2rem;">驴Quieres ser mi San Valent铆n?</h2>
             <button class="btn-magic" onclick="finish()">S铆, Juro</button>
             <button class="btn-magic" id="no-btn" style="border: none; font-size: 0.8rem;" onclick="handleNo()">No</button>
        </div>
    </div>

</div>

<script>
    const data = {
        qs: [
            { q: "驴En qu茅 fecha comenz贸 nuestra historia? (DD/MM/AAAA)", a: "24/04/2024" },
            { q: "驴Cu谩l fue la primera foto nuestra que te gust贸?", a: "espejo" },
            { q: "驴A qu茅 lugar m谩gico viajamos juntos por primera vez?", a: "ayacucho" }
        ],
        errors: ["El pergamino rechaza esa respuesta...", "Intenta concentrarte...", "La tinta se borra..."]
    };

    let step = 0;
    let noCount = 0;

    // --- FUNCIN DE INICIO CINEMATOGRFICO ---
    function startCinematic() {
        const intro = document.getElementById('intro-layer');
        const parchment = document.getElementById('parchment-layer');
        const content = document.getElementById('map-content');
        const music = document.getElementById('bg-music');

        // 1. M煤sica
        music.volume = 0.5;
        music.play();

        // 2. Transici贸n Lenta
        intro.style.opacity = 0;
        
        setTimeout(() => {
            intro.style.display = 'none';
            // Fondo aparece suavemente
            parchment.style.opacity = 1;
            
            // Iniciar huellas
            startFootsteps();

            // Contenido aparece despu茅s del fondo
            content.classList.remove('hidden');
            setTimeout(() => {
                content.style.opacity = 1;
                loadQuestion();
            }, 1000);
        }, 2000);
    }

    // --- LOGICA DE HUELLAS (ANIMACIN) ---
    function startFootsteps() {
        setInterval(() => {
            if(Math.random() > 0.6) return; // Aleatoriedad
            
            const foot = document.createElement('div');
            foot.innerHTML = "";
            foot.className = 'footstep';
            
            // Posici贸n aleatoria
            foot.style.left = Math.random() * 80 + 10 + '%';
            foot.style.top = Math.random() * 80 + 10 + '%';
            
            // Rotaci贸n aleatoria para parecer caminar
            foot.style.transform = `rotate(${Math.random() * 360}deg)`;
            
            // Animaci贸n
            foot.style.animation = "walk 4s forwards";
            
            document.getElementById('parchment-layer').appendChild(foot);
            
            // Limpieza
            setTimeout(() => foot.remove(), 4000);
        }, 800);
    }

    function loadQuestion() {
        const textEl = document.getElementById('q-text');
        // Reiniciar animaci贸n de tinta
        textEl.classList.remove('ink-reveal');
        void textEl.offsetWidth; // Trigger reflow
        textEl.classList.add('ink-reveal');
        
        textEl.innerText = data.qs[step].q;
        document.getElementById('ans-input').value = "";
        document.getElementById('feedback').innerText = "";
    }

    function checkAnswer() {
        const input = document.getElementById('ans-input').value.toLowerCase().trim();
        const correct = data.qs[step].a.toLowerCase();
        
        // Validaci贸n flexible para "espejo"
        let ok = false;
        if (step === 1 && (input.includes("espejo") || input.includes("foto"))) ok = true;
        else if (input === correct) ok = true;

        if (ok) {
            step++;
            if(step < data.qs.length) {
                // Efecto de transici贸n suave
                document.getElementById('map-content').style.opacity = 0;
                setTimeout(() => {
                    loadQuestion();
                    document.getElementById('map-content').style.opacity = 1;
                }, 1000);
            } else {
                showFinal();
            }
        } else {
            const err = document.getElementById('feedback');
            err.innerText = data.errors[Math.floor(Math.random()*data.errors.length)];
            // Temblor suave
            document.getElementById('map-content').style.transform = "translateX(5px)";
            setTimeout(()=>document.getElementById('map-content').style.transform = "translateX(0)", 200);
        }
    }

    function showFinal() {
        document.getElementById('game-section').classList.add('hidden');
        document.getElementById('header-section').classList.add('hidden');
        
        const final = document.getElementById('final-section');
        final.classList.remove('hidden');
        // Animaci贸n de entrada
        final.style.opacity = 0;
        setTimeout(() => final.style.opacity = 1, 500);
    }

    function handleNo() {
        const texts = ["驴Segura?", "Pi茅nsalo bien...", "Imposible.", "Wen, por favor..."];
        document.getElementById('no-btn').innerText = texts[noCount % texts.length];
        noCount++;
    }

    function finish() {
        alert("わ 隆Gracias por aceptar esta travesura! Te amo.");
    }
    
    // Enter key
    document.getElementById('ans-input').addEventListener("keypress", (e) => {
        if(e.key === "Enter") checkAnswer();
    });

</script>
</body>
</html>
